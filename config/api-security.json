{
  "rateLimiting": {
    "global": {
      "windowMs": 900000,
      "maxRequests": 1000,
      "message": "Too many requests from this IP, please try again later",
      "standardHeaders": true,
      "legacyHeaders": false,
      "skipFailedRequests": false,
      "skipSuccessfulRequests": false,
      "keyGenerator": "ip",
      "onLimitReached": "log_and_block"
    },
    "distributed": {
      "enabled": true,
      "store": "redis",
      "prefix": "bitflow:ratelimit:",
      "resetExpiryOnChange": false
    },
    "endpoints": {
      "/api/streams": {
        "windowMs": 60000,
        "maxRequests": 100,
        "skipSuccessfulRequests": false
      },
      "/api/streams/create": {
        "windowMs": 60000,
        "maxRequests": 10,
        "skipSuccessfulRequests": false
      },
      "/api/subscriptions": {
        "windowMs": 60000,
        "maxRequests": 50,
        "skipSuccessfulRequests": false
      },
      "/api/auth/login": {
        "windowMs": 900000,
        "maxRequests": 5,
        "skipSuccessfulRequests": true
      },
      "/api/webhooks": {
        "windowMs": 60000,
        "maxRequests": 1000,
        "skipSuccessfulRequests": false
      }
    },
    "authenticated": {
      "windowMs": 60000,
      "maxRequests": 500,
      "keyGenerator": "user-id"
    }
  },
  "cors": {
    "production": {
      "origin": [
        "https://bitflow.app",
        "https://www.bitflow.app",
        "https://api.bitflow.app"
      ],
      "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "allowedHeaders": [
        "Content-Type",
        "Authorization",
        "X-API-Key",
        "X-Requested-With"
      ],
      "credentials": true,
      "maxAge": 86400
    },
    "staging": {
      "origin": [
        "https://staging.bitflow.app",
        "http://localhost:3000",
        "http://localhost:3001"
      ],
      "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "allowedHeaders": [
        "Content-Type",
        "Authorization",
        "X-API-Key",
        "X-Requested-With"
      ],
      "credentials": true,
      "maxAge": 3600
    }
  },
  "authentication": {
    "jwt": {
      "algorithm": "HS256",
      "expiresIn": "24h",
      "refreshTokenExpiresIn": "7d",
      "issuer": "bitflow-api",
      "audience": "bitflow-users"
    },
    "apiKeys": {
      "headerName": "X-API-Key",
      "rateLimitMultiplier": 5,
      "allowedScopes": [
        "streams:read",
        "streams:write",
        "subscriptions:read",
        "subscriptions:write",
        "webhooks:read",
        "webhooks:write"
      ]
    },
    "oauth": {
      "providers": {
        "google": {
          "clientId": "${GOOGLE_OAUTH_CLIENT_ID}",
          "clientSecret": "${GOOGLE_OAUTH_CLIENT_SECRET}",
          "scope": ["openid", "email", "profile"]
        },
        "github": {
          "clientId": "${GITHUB_OAUTH_CLIENT_ID}",
          "clientSecret": "${GITHUB_OAUTH_CLIENT_SECRET}",
          "scope": ["user:email"]
        }
      }
    }
  },
  "security": {
    "helmet": {
      "contentSecurityPolicy": {
        "directives": {
          "defaultSrc": ["'self'"],
          "styleSrc": ["'self'", "'unsafe-inline'"],
          "scriptSrc": ["'self'"],
          "imgSrc": ["'self'", "data:", "https:"],
          "connectSrc": ["'self'", "wss:", "https:"],
          "fontSrc": ["'self'"],
          "objectSrc": ["'none'"],
          "mediaSrc": ["'self'"],
          "frameSrc": ["'none'"]
        }
      },
      "crossOriginEmbedderPolicy": false,
      "hsts": {
        "maxAge": 31536000,
        "includeSubDomains": true,
        "preload": true
      }
    },
    "encryption": {
      "algorithm": "aes-256-gcm",
      "keyDerivation": "pbkdf2",
      "iterations": 100000,
      "saltLength": 32,
      "ivLength": 16
    },
    "validation": {
      "maxRequestSize": "10mb",
      "maxParameterLength": 1000,
      "allowedFileTypes": ["image/jpeg", "image/png", "application/pdf"],
      "maxFileSize": "5mb"
    }
  },
  "monitoring": {
    "requestLogging": {
      "enabled": true,
      "logLevel": "info",
      "includeHeaders": false,
      "includeBody": false,
      "excludePaths": ["/health", "/metrics"]
    },
    "securityEvents": {
      "logFailedAuth": true,
      "logRateLimitExceeded": true,
      "logSuspiciousActivity": true,
      "alertThresholds": {
        "failedAuthAttempts": 10,
        "rateLimitViolations": 50,
        "suspiciousRequests": 5
      }
    }
  },
  "ipWhitelist": {
    "enabled": false,
    "allowedIps": [],
    "allowedCidrs": []
  },
  "ipBlacklist": {
    "enabled": true,
    "blockedIps": [],
    "blockedCidrs": [],
    "autoBlock": {
      "enabled": true,
      "threshold": 100,
      "duration": 3600,
      "escalation": {
        "enabled": true,
        "levels": [
          {"violations": 10, "duration": 300},
          {"violations": 50, "duration": 1800},
          {"violations": 100, "duration": 3600},
          {"violations": 200, "duration": 86400}
        ]
      }
    },
    "geoBlocking": {
      "enabled": false,
      "blockedCountries": [],
      "allowedCountries": []
    }
  },
  "ddosProtection": {
    "enabled": true,
    "thresholds": {
      "requestsPerSecond": 100,
      "concurrentConnections": 1000,
      "bandwidthMbps": 100
    },
    "mitigation": {
      "challengeResponse": true,
      "temporaryBlocking": true,
      "trafficShaping": true
    }
  },
  "waf": {
    "enabled": true,
    "rules": {
      "sqlInjection": true,
      "xss": true,
      "pathTraversal": true,
      "commandInjection": true,
      "remoteFileInclusion": true
    },
    "customRules": [
      {
        "name": "block_crypto_mining",
        "pattern": "/(mining|miner|cryptonight)/i",
        "action": "block"
      },
      {
        "name": "suspicious_user_agents",
        "pattern": "/(bot|crawler|spider|scraper)/i",
        "action": "challenge"
      }
    ]
  }
}